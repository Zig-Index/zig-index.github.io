---
import Layout from "@/layouts/Layout.astro";
import { PrivacyPage } from "../components/PrivacyPage";
import { loadRegistryData } from "../lib/registryLoader";

// Load registry data for search functionality
const allEntries = await loadRegistryData();

// Prepare search items for navbar
const searchItems = allEntries.map(e => ({
  name: e.name,
  owner: e.owner,
  repo: e.repo,
  description: e.description,
  category: e.category,
  type: e.type,
  fullName: `${e.owner}/${e.repo}`,
}));

const siteName = import.meta.env.PUBLIC_SITE_NAME || "Zig Index";
const pageTitle = `Privacy Policy | ${siteName}`;
const pageDescription = `Privacy Policy for ${siteName} - Learn how we collect, use, and protect your information on this unofficial Zig package index.`;

const siteUrl = import.meta.env.PUBLIC_SITE_URL || "https://zig-index.github.io";

const schema = {
  "@context": "https://schema.org",
  "@type": "WebPage",
  "name": `Privacy Policy - ${siteName}`,
  "description": `Privacy policy for ${siteName}, an unofficial, community-driven index of Zig packages and applications. Not affiliated with the Zig Software Foundation.`,
  "url": `${siteUrl}/privacy`,
  "publisher": {
    "@type": "Organization",
    "name": siteName,
    "url": siteUrl
  }
};
---

<Layout title={pageTitle} description={pageDescription} schema={schema}>
  <PrivacyPage client:load searchItems={searchItems} />
</Layout>
