---
import Layout from "@/layouts/Layout.astro";
import { TermsPage } from "../components/TermsPage";
import { loadRegistryData } from "../lib/registryLoader";
import type { SearchItem } from "../lib/schemas";

// Load registry data for search functionality
const allEntries = await loadRegistryData();

// Prepare search items for navbar
const searchItems = allEntries.map(e => ({
  name: e.name,
  owner: e.owner,
  repo: e.repo,
  description: e.description,
  category: e.category,
  type: e.type,
  fullName: `${e.owner}/${e.repo}`,
})) as SearchItem[];

const siteName = import.meta.env.PUBLIC_SITE_NAME || "Zig Index";
const pageTitle = `Terms of Service | ${siteName}`;
const pageDescription = `Terms of Service for ${siteName} - Community guidelines and usage terms for this unofficial Zig package index.`;

const siteUrl = import.meta.env.PUBLIC_SITE_URL || "https://zig-index.github.io";

const schema = {
  "@context": "https://schema.org",
  "@type": "WebPage",
  "name": `Terms of Service - ${siteName}`,
  "description": `Terms of service for ${siteName}, an unofficial, community-driven index of Zig packages and applications. Not affiliated with the Zig Software Foundation.`,
  "url": `${siteUrl}/terms`,
  "publisher": {
    "@type": "Organization",
    "name": siteName,
    "url": siteUrl
  }
};
---

<Layout title={pageTitle} description={pageDescription} schema={schema}>
  <TermsPage client:load searchItems={searchItems} />
</Layout>
